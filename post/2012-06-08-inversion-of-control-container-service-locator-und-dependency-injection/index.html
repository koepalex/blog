<!doctype html><html lang=de-de><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content><meta property="og:type" content="article"><meta property="og:image" content="https://www.alexander-koepke.de//koepalex.logo.gif"><meta property="twitter:image" content="https://www.alexander-koepke.de//koepalex.logo.gif"><meta name=title content="Inversion Of Control(-Container), Service Locator und Dependency Injection"><meta property="og:title" content="Inversion Of Control(-Container), Service Locator und Dependency Injection"><meta property="twitter:title" content="Inversion Of Control(-Container), Service Locator und Dependency Injection"><meta name=description content="Technical articles, the Universe and the all the rest"><meta property="og:description" content="Technical articles, the Universe and the all the rest"><meta property="twitter:description" content="Technical articles, the Universe and the all the rest"><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=/img/favicon.ico><title>Inversion Of Control(-Container), Service Locator und Dependency Injection | </title><link rel=canonical href=/post/2012-06-08-inversion-of-control-container-service-locator-und-dependency-injection/><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/css/zanshang.css><link rel=stylesheet href=/css/font-awesome.all.min.css><script src=/js/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/hux-blog.min.js></script><script src=/js/lazysizes.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=/></a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/>All Posts</a></li><li><a href=/categories/dotnet/>dotnet</a></li><li><a href=/categories/miscellaneous/>miscellaneous</a></li><li><a href=/categories/til/>til</a></li><li><a href=/about//>ABOUT</a></li><li><a href=/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/koepalex.logo.gif)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags><a class=tag href=/tags/dotnet title=dotnet>dotnet
</a><a class=tag href=/tags/dependency-injection title=dependency-injection>dependency-injection
</a><a class=tag href=/tags/di title=di>di
</a><a class=tag href=/tags/inversion-of-control title=inversion-of-control>inversion-of-control
</a><a class=tag href=/tags/ioc title=ioc>ioc
</a><a class=tag href=/tags/service-locator title=service-locator>service-locator</a></div><h1>Inversion Of Control(-Container), Service Locator und Dependency Injection</h1><h2 class=subheading></h2><span class=meta>Posted by
on
Friday, June 8, 2012</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><p>IOC-Container und DI sind zurzeit in vielen Fachzeitschriften diskutiert. Hier der Versuch einer kompakte Übersicht, die IOC, DI, SL und IOC-Container im Zusammenspiel erklärt.</p><p><strong><em>Inversion Of Control</em></strong></p><p>Beschreibt ein Paradigma zum Entwerfen von Frameworks. Ein Unterschied zwischen einem Framework und einer Bibliothek besteht darin, dass in einem Framework Methoden vom Verwender des Framework aufgerufen werden. Dies verändert den Kontrollfluss, bei einer klassischen Bibliothek, ruft der Verwender eine Methode auf, deren Funktionalität wird abgearbeitet und die Methode kehrt zum Aufrufer zurück. Die Steuerung des Kontrollflusses liegt also in der Hand des Verwenders der Bibliothek. Ein gutes Beispiel ist das .NET Framework, der Verwender kann Methoden über Events an Ereignisse binden, dass .NET Framework entscheidet, wann es die Funktionalität des Verwenders aufruft.</p><p>Konkretisiert wurde das Thema von Martin Fowler: <a href=http://martinfowler.com/bliki/InversionOfControl.html>http://martinfowler.com/bliki/InversionOfControl.html</a></p><p><strong><em>Dependency Injection</em></strong></p><p>Ist eine Anwendung von Inversion of Control, speziell im Bereich der Objekterzeugung. Objekte werden nicht mehr direkt erzeugt und initialisiert, dies geschieht von dem Verwender der Funktionalität. In vielen wird diese Aufgabe durch eine über Meta konfigurierbare Komponente erfüllt. Martin Fowler unterscheidet drei Typen von Dependency Injection:</p><ul><li>Constructor Injection – die zu verwendenden Objekte werden beim Initialisieren des Objektes über den Konstruktor mitgegeben.</li><li>Setter Injection – die zu verwendenden Objekte können über Eigenschaften der Klasse gesetzt werden.</li><li>Interface Injection – das Framework Objekt stellt ein Interface bereit, welches vom Verwender zu implementieren ist. Darüber werden Abhängigkeiten zur Laufzeit aufgelöst.</li></ul><p>Die Typen basieren darauf, die injizierte Abhängigkeit als Teil des Objektes zu speichern. Das funktioniert bei kleinen Objekten mit geringen Lebenszeiten sehr gut.</p><p>Oft gibt es aber auch eine Art Method Dependency Injection, bei welcher einer Methode über ihre Parameter, die zu verwendenden Objekte mitgegeben werden, anstatt dass die Methode sie selbst erstellt.</p><p>Weitere Informationen finden Sie unter <a href=http://www.martinfowler.com/articles/injection.html>http://www.martinfowler.com/articles/injection.html</a></p><p><strong><em>Service Locator</em></strong></p><p>Die Idee ist es im Programm eine „Anlaufstelle“ für Services zu besitzen. Dort können verschiedene Services registriert und auch abgefragt werden. In den meisten Programmen genügt als ServiceLocator eine Singleton Klasse mit einer einfachen Schnittstelle wie:</p><p>public interface IServiceLocator { T Load (string idOfService); }</p><p>Die Möglichkeiten der Realisierung des Service Locator sind vielfältig:</p><ul><li>Konfiguration zur Laufzeit, dabei werden IDs und konkrete Instanzen hinterlegt.</li><li>In Meta-Dateien beschriebene IDs mit Angabe von Assembly und Klassennamen, zur Instanzierung mittels Reflection.</li><li>Über Reflektion alle Typen suchen, welche ein entsprechendes Custom-Attribut besitzen.</li><li>usw.</li></ul><p>Weite Informationen finden Sie unter <a href=http://www.martinfowler.com/articles/injection.html#UsingAServiceLocator>http://www.martinfowler.com/articles/injection.html#UsingAServiceLocator</a></p><p><strong><em>IOC-Container</em></strong></p><p>IOC-Container werden auch als Dependency Injection Container bezeichnet. Ihr Aufgabe besteht darin, eine Klasse von der Objekterzeugung zu entkoppeln. Ein Beispiel:</p><p>Stellen Sie sich einen AVL-Suchbaum vor, dieser arbeitet mit AVL-Knoten, die ein Interface erfüllen wie:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#ff79c6>interface</span> <span style=color:#50fa7b>IAvlNode</span>&lt;T, K&gt; 
</span></span><span style=display:flex><span>{ 
</span></span><span style=display:flex><span>  T Key{<span style=color:#ff79c6>get</span>; <span style=color:#ff79c6>set</span>;} 
</span></span><span style=display:flex><span>  K Value {<span style=color:#ff79c6>get</span>; <span style=color:#ff79c6>set</span>;} 
</span></span><span style=display:flex><span>  IAvlNode&lt;T, K&gt; LeftChild {<span style=color:#ff79c6>get</span>; <span style=color:#ff79c6>set</span>;} 
</span></span><span style=display:flex><span>  IAvlNode&lt;T, K&gt; RightChild {<span style=color:#ff79c6>get</span>; <span style=color:#ff79c6>set</span>;}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Nun sollen Elemente in den AVL-Suchbaum eingefügt werden, dass bedeutet der Baum muss, einen neuen Knoten erstellen und ihn in den Baum einfügen und ggf. sich neu gewichten. Hier liegt das Problem, der Baum erstellt den Knoten. Das sorgt für eine hohe Kopplung zwischen Baum und Knoten. Wenn die Kopplung nicht existieren würde, könnte im Baum Knoten geben, welche Ihre Daten sofort auf Festplatte serialisieren, oder Knoten die Ihre Daten remote auf Servern hinterlegen oder anderes erledigen. In einen fragwürdigen Design würde man der Baum die Logik enthalten, wann welche Art von Knoten zu erstellen ist. Den entsprechenden Knoten über Dependency Injektion in die Baum-Klasse zuübergeben, ist auch nicht praktikabel z.B. wenn der Baum, dass Standard interface IDictionary&lt;T,K> erfüllen soll. Für dieses Problem stellt der IOC-Container eine Lösung da, er wird mit den Abhängigkeiten befüllt. Und der Baum kann an dem Container mittels Resolve(); einen Knoten erstellen lassen und damit Arbeiten.</p><p>Es gibt eine lange Liste an bekannten IOC-Containern (siehe <a href=http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx>http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx</a>) und Ihre Arbeitsweise ist sehr vielfältig. Es geht von im Meta-Dateien beschriebenen Abhängigkeiten, über Registrierung zur Laufzeit bis hin zu Callback basierten Systemen.</p><p>Besonders möchte ich auf dieses Video, in welchem ein einfacher IOC-Container in 15min entwickelt wird, hinweisen: <a href="https://www.youtube.com/watch?v=cfvTfU5RK8Q">https://www.youtube.com/watch?v=cfvTfU5RK8Q</a></p><p><em><strong>Warum das Ganze?</strong></em></p><ul><li>lose Kopplung (kein direktes Anlegen von Objekten)</li><li>erhöhte Testbarkeit (es werden richtige Unit-Tests möglich)</li><li>Erhöhung der Wiederverwendbarkeit (siehe Baum Beispiel)</li></ul><p><strong><em>Wie kommt meine Klasse zu dem IOC-Container?</em></strong></p><p>Die Antwort ist ganz klar Dependency Injection oder Service Locator.</p><p><strong><em>Welche Nachteile ergeben sich durch Verwendung von IOC(-Container), DI und SL?</em></strong></p><p>Je nach verwendeter Technology kann es zu schwer zu verstehenden Config-Dateien kommen. Der Quelltext ist anfänglich auch schwerer zu lesen (wobei einige Befürworter natürlich sagen, der Quelltext ist leichter zu lesen). Im Allgemeinen überwiegen die Vorteile einfach.</p><hr><ul class=pager><li class=previous><a href=/post/2012-04-20-vermeidung-von-switch-case-zur-typen-bestimmung-beim-aufruf-von-generischen-methoden-3/ data-toggle=tooltip data-placement=top title="Vermeidung von switch-case zur Typen Bestimmung beim Aufruf von generischen Methoden">&larr;
Previous Post</a></li><li class=next><a href=/post/2012-07-28-dsls-extension-methods-und-fluent-interfaces/ data-toggle=tooltip data-placement=top title="DSLs, Extension Methods und Fluent Interfaces">Next
Post &rarr;</a></li></ul></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:this-is@alexander-koepke.de><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://twitter.com/koepalex><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/koepalex><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/alexander-k%c3%b6pke-3222a21b7/><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://stackoverflow.com/users/9474615/koepalex><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=@koepalex@dotnet.social><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-mastodon fa-stack-1x fa-inverse"></i></span></a></li><li><a href rel=alternate type=application/rss+xml title><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> by <a href=https://zhaohuabing.com>Huabing</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){t=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),n=$(this).text(),i=$('<a href="'+o+'" rel="nofollow">'+n+"</a>"),s=$('<li class="'+t+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script></body></html>